import BasePage from './base-component';

export default class SignInPage extends BasePage {
  static getSelf() {
    return cy.get('#register-form');
  }

  static get() {
    return cy.visit('/login');
  }

  static getTitleElement() {
    return cy.get('#login-title');
  }

  static getUsernameElement() {
    return cy.get('#username');
  }

  static getPasswordElement() {
    return cy.get('#password');
  }

  static getLoginButton() {
<%_ if (authenticationType !== 'oauth2') { _%>
    return cy.get('button[type=submit]');
<%_ } else {_%>
    return cy.get('input[type=submit]');
<%_ } _%>
  }

  static getTitle() {
    return this.getTitleElement().invoke('attr', 'id');
  }

  static setUserName(username: string) {
    return this.getUsernameElement().type(username);
  }

  static clearUserName() {
    return this.getUsernameElement().clear();
  }

  static setPassword(password: string) {
    return this.getPasswordElement().type(password);
  }

  static clearPassword() {
    return this.getPasswordElement().clear();
  }

<%_ if (authenticationType !== 'oauth2') { _%>
  static autoSignInUsing(username: string, password: string) {
    this.setUserName(username);
    this.setPassword(password);
    return this.login();
  }
<%_ } else { _%>
  static loginWithOAuth(username: string, password: string) {
    this.getUsernameElement().then($usernameElement => {
      if ($usernameElement.length) {
        this.setUserName(username);
        this.setPassword(password);
        this.login();
      }
    });
  }
<%_ } _%>

  static autoSignOut() {
    return cy.visit('/logout');
  }

  static login() {
    return this.getLoginButton().click();
  }
}
