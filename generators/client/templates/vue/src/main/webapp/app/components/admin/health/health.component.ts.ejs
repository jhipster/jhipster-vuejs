import HealthService from './health.service';
import <%=jhiPrefixCapitalized%>HealthModal from './health-modal.vue';
import { Component } from 'vue-property-decorator';
import { mixins } from 'vue-class-component';

@Component({
  components: {
    'health-modal': <%=jhiPrefixCapitalized%>HealthModal
  }
})
export default class <%=jhiPrefixCapitalized%>Health extends mixins(HealthService) {
  public healthData: any;
  public currentHealth: any;
  public updatingHealth: boolean;

  constructor() {
    super();
    this.healthData = null;
    this.currentHealth = null;
    this.updatingHealth = false;
  }

  public mounted(): void {
    this.refresh();
  }

  public baseName(name: any): any {
    return this.getBaseName(name);
  }

  public getBadgeClass(statusState: any): String {
    if (statusState === 'UP') {
      return 'badge-success';
    } else {
      return 'badge-danger';
    }
  }

  public refresh(): void {
    this.updatingHealth = true;
    this.checkHealth().then(res => {
      this.healthData = this.transformHealthData(res.data);
      this.updatingHealth = false;
    })
      .catch(error => {
        if (error.status === 503) {
          this.healthData = this.transformHealthData(error.error);
        }
        this.updatingHealth = false;
      });
  }


  public showHealth(health: any): void {
    this.currentHealth = health;
    (<any>this.$refs.healthModal).show();
  }

  public subSystemName(name: String): String {
    return this.getSubSystemName(name);
  }
}
